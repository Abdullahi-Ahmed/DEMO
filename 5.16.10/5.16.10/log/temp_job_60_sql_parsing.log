token frm tRestClient: eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJhdXRoMHw1ZmE3YzBhNDc1NzM3NjAwNzZjZTIzZjQiLCJpYXQiOjE2OTA5MTA2MTMsInN1YiI6InNxbGZsb3ciLCJpc3MiOiJyb2JlcnRAZW9uY29sbGVjdGl2ZS5jb20iLCJleHAiOjE2OTA5OTcwMTN9.JXLDwXCyEmpBhICpZ_Jiln6x94937CdM-10djWvUI04
.----+------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------.
|                                                                                                        <b>__UNIQUE_NAME__</b><br>Print code, userid<br>and token                                                                                                        |
|=---+------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------=|
|code|userId                        |token                                                                                                                                                                                                                                |
|=---+------------------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------=|
|200 |auth0|5fa7c0a47573760076ce23f4|eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJhdXRoMHw1ZmE3YzBhNDc1NzM3NjAwNzZjZTIzZjQiLCJpYXQiOjE2OTA5MTA2MTMsInN1YiI6InNxbGZsb3ciLCJpc3MiOiJyb2JlcnRAZW9uY29sbGVjdGl2ZS5jb20iLCJleHAiOjE2OTA5OTcwMTN9.JXLDwXCyEmpBhICpZ_Jiln6x94937CdM-10djWvUI04|
'----+------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'

QueryName - global Variable :models\marts\core\dim_customers
sql_query - global Variable :with customers as (
    select * from analytics.DBT_GGITHIRI.stg_customers
),

orders as (
    select * from analytics.DBT_GGITHIRI.fct_orders
),

customer_orders as (
    select
        customer_id,
        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders,
        sum(amount) as lifetime_value
    from orders
    group by 1
),

final as (
    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        customer_orders.lifetime_value,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
    from customers
    left join
        customer_orders
        on customers.customer_id = customer_orders.customer_id
)

select * from final
jsonfilename from global var : models\marts\core\dim_customers.json
.----------+---------+------.
|<b>__UNIQUE_NAME__</b><br>syntax error in store proc|
|=---------+---------+-----=|
|statusCode|QueryName|string|
|=---------+---------+-----=|
'----------+---------+------'

.---------+------------.
|<b>__UNIQUE_NAME__</b><br>capture any rest api errors|
|=--------+-----------=|
|errorCode|errorMessage|
|=--------+-----------=|
'---------+------------'

.----------+---------+------.
|<b>__UNIQUE_NAME__</b><br>syntax error in store proc|
|=---------+---------+-----=|
|statusCode|QueryName|string|
|=---------+---------+-----=|
'----------+---------+------'

.---------+------------.
|<b>__UNIQUE_NAME__</b><br>capture any rest api errors|
|=--------+-----------=|
|errorCode|errorMessage|
|=--------+-----------=|
'---------+------------'

.----------+---------+------.
|<b>__UNIQUE_NAME__</b><br>syntax error in store proc|
|=---------+---------+-----=|
|statusCode|QueryName|string|
|=---------+---------+-----=|
'----------+---------+------'

.---------+------------.
|<b>__UNIQUE_NAME__</b><br>capture any rest api errors|
|=--------+-----------=|
|errorCode|errorMessage|
|=--------+-----------=|
'---------+------------'

.----------+---------+------.
|<b>__UNIQUE_NAME__</b><br>syntax error in store proc|
|=---------+---------+-----=|
|statusCode|QueryName|string|
|=---------+---------+-----=|
'----------+---------+------'

.---------+------------.
|<b>__UNIQUE_NAME__</b><br>capture any rest api errors|
|=--------+-----------=|
|errorCode|errorMessage|
|=--------+-----------=|
'---------+------------'

.----------+---------+------.
|<b>__UNIQUE_NAME__</b><br>syntax error in store proc|
|=---------+---------+-----=|
|statusCode|QueryName|string|
|=---------+---------+-----=|
'----------+---------+------'

.---------+------------.
|<b>__UNIQUE_NAME__</b><br>capture any rest api errors|
|=--------+-----------=|
|errorCode|errorMessage|
|=--------+-----------=|
'---------+------------'

.----------+---------+------.
|<b>__UNIQUE_NAME__</b><br>syntax error in store proc|
|=---------+---------+-----=|
|statusCode|QueryName|string|
|=---------+---------+-----=|
'----------+---------+------'

.---------+------------.
|<b>__UNIQUE_NAME__</b><br>capture any rest api errors|
|=--------+-----------=|
|errorCode|errorMessage|
|=--------+-----------=|
'---------+------------'

